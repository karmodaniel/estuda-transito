<div class="estudo-page">
  <!-- Header Fixo -->
  <header class="page-header">
    <h1>Placas de Tr√¢nsito</h1>

    <!-- Barra de Busca Centralizada -->
    <div class="search-container">
      <div class="search-input-wrapper">
        <input
          type="text"
          [value]="termoBusca()"
          (input)="onTermoBuscaChange($event)"
          placeholder="Buscar por nome, c√≥digo ou descri√ß√£o"
          class="search-input"
        />
        <span class="search-icon">üîç</span>
      </div>
    </div>
  </header>

  <div class="main-content">
    <!-- √Årea de Filtros (Lateral em Desktop) -->
    <aside class="filters-sidebar">
      <div class="filters-accordion" [class.mobile-open]="mobileFiltersOpen()">
        <!-- Filtro por Categoria -->
        <div class="accordion-panel">
          <div class="accordion-header" (click)="toggleAccordion('categoria')">
            <span class="accordion-title">Categoria da Placa</span>
            <span
              class="accordion-icon"
              [class.expanded]="accordionStates().categoria"
            >
              ‚ñº
            </span>
          </div>
          <div
            class="accordion-content"
            [class.expanded]="accordionStates().categoria"
          >
            <div class="checkbox-list">
              <label class="checkbox-item">
                <input
                  type="checkbox"
                  [checked]="categoriaSelecionada() === null"
                  (change)="onCategoriaChange(null)"
                />
                <span class="checkbox-label">Todas as categorias</span>
              </label>
              @for (categoria of categorias(); track categoria.codigo) {
              <label class="checkbox-item">
                <input
                  type="checkbox"
                  [checked]="categoriaSelecionada() === categoria.codigo"
                  (change)="onCategoriaChange(categoria.codigo)"
                />
                <span class="checkbox-label">{{ categoria.nome }}</span>
              </label>
              }
            </div>
          </div>
        </div>

        <!-- Filtro de Campos Omitidos -->
        <div class="accordion-panel">
          <div class="accordion-header" (click)="toggleAccordion('campos')">
            <span class="accordion-title">Omitir informa√ß√µes</span>
            <span
              class="accordion-icon"
              [class.expanded]="accordionStates().campos"
            >
              ‚ñº
            </span>
          </div>
          <div
            class="accordion-content"
            [class.expanded]="accordionStates().campos"
          >
            <div class="checkbox-list">
              <label class="checkbox-item">
                <input
                  type="checkbox"
                  [checked]="filtrosExibicao().mostrarNome"
                  (change)="onFiltroExibicaoChange('mostrarNome')"
                />
                <span class="checkbox-label">Nome da Placa</span>
              </label>
              <label class="checkbox-item">
                <input
                  type="checkbox"
                  [checked]="filtrosExibicao().mostrarCodigo"
                  (change)="onFiltroExibicaoChange('mostrarCodigo')"
                />
                <span class="checkbox-label">C√≥digo</span>
              </label>
              <label class="checkbox-item">
                <input
                  type="checkbox"
                  [checked]="filtrosExibicao().mostrarDescricao"
                  (change)="onFiltroExibicaoChange('mostrarDescricao')"
                />
                <span class="checkbox-label">Descri√ß√£o</span>
              </label>
              <label class="checkbox-item">
                <input
                  type="checkbox"
                  [checked]="filtrosExibicao().mostrarCategoria"
                  (change)="onFiltroExibicaoChange('mostrarCategoria')"
                />
                <span class="checkbox-label">Categoria</span>
              </label>
            </div>
          </div>
        </div>
      </div>

      <!-- Bot√£o para mobile -->
      <button class="mobile-filters-toggle" (click)="toggleMobileFilters()">
        <span>Filtros</span>
        <span class="toggle-icon" [class.expanded]="mobileFiltersOpen()"
          >‚ñº</span
        >
      </button>
    </aside>

    <!-- √Årea de Conte√∫do Principal -->
    <main class="content-main">
      <!-- Informa√ß√µes da Listagem -->
      <div class="listing-info">
        <div class="results-counter">
          Exibindo {{ totalPlacasFiltradas() }} de {{ totalPlacas() }} placas
        </div>

        <div class="view-toggle">
          <button
            class="view-button"
            [class.active]="modoVisualizacao() === 'lista'"
            (click)="modoVisualizacao.set('lista')"
            title="Modo Lista"
          >
            <span class="view-icon">‚ò∞</span>
          </button>
          <button
            class="view-button"
            [class.active]="modoVisualizacao() === 'grid'"
            (click)="modoVisualizacao.set('grid')"
            title="Modo Grid"
          >
            <span class="view-icon">‚äû</span>
          </button>
        </div>
      </div>

      <!-- √Årea de Resultados -->
      <div class="results-container">
        <div
          class="placas-container"
          [class.modo-lista]="modoVisualizacao() === 'lista'"
          [class.modo-grid]="modoVisualizacao() === 'grid'"
        >
          @for (placa of placasFiltradas(); track placa.codigo) {
          <app-placa-card
            [placa]="placa"
            [filtrosExibicao]="filtrosExibicao()"
            [modoVisualizacao]="modoVisualizacao()"
            (cardClick)="onPlacaClick(placa)"
          ></app-placa-card>
          }
        </div>

        @if (placasFiltradas().length === 0) {
        <div class="sem-resultados">
          <p>Nenhuma placa encontrada com os filtros aplicados.</p>
          <button (click)="limparFiltros()">Limpar Filtros</button>
        </div>
        }
      </div>
    </main>
  </div>
</div>
